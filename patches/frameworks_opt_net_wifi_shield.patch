diff --git a/service/java/com/android/server/wifi/WifiNative.java b/service/java/com/android/server/wifi/WifiNative.java
index 84c659d..f8c45fa 100644
--- a/service/java/com/android/server/wifi/WifiNative.java
+++ b/service/java/com/android/server/wifi/WifiNative.java
@@ -902,6 +902,10 @@ public class WifiNative {
         return doBooleanCommand("WPS_CANCEL");
     }
 
+    public boolean cancelWps(String iface) {
+        return doBooleanCommandNative("IFNAME=" + iface + " WPS_CANCEL");
+    }
+
     public boolean setPersistentReconnect(boolean enabled) {
         int value = (enabled == true) ? 1 : 0;
         return doBooleanCommand("SET persistent_reconnect " + value);
diff --git a/service/java/com/android/server/wifi/p2p/WifiP2pServiceImpl.java b/service/java/com/android/server/wifi/p2p/WifiP2pServiceImpl.java
index ff814cd..7b03867 100644
--- a/service/java/com/android/server/wifi/p2p/WifiP2pServiceImpl.java
+++ b/service/java/com/android/server/wifi/p2p/WifiP2pServiceImpl.java
@@ -339,6 +339,7 @@ public final class WifiP2pServiceImpl extends IWifiP2pManager.Stub {
               case WifiP2pManager.STOP_LISTEN:
               case WifiP2pManager.SET_CHANNEL:
               case WifiP2pManager.START_WPS:
+              case WifiP2pManager.CANCEL_WPS:
               case WifiP2pManager.ADD_LOCAL_SERVICE:
               case WifiP2pManager.REMOVE_LOCAL_SERVICE:
               case WifiP2pManager.CLEAR_LOCAL_SERVICES:
@@ -464,6 +465,13 @@ public final class WifiP2pServiceImpl extends IWifiP2pManager.Stub {
         mP2pStateMachine.sendMessage(SET_MIRACAST_MODE, mode);
     }
 
+    /** This is used to provide the information that there is an active autonomous GO and
+      * applications should call create/remove p2p interface accordingly
+      */
+    public boolean isAutonomousGroupOwner() {
+        return mAutonomousGroup;
+    }
+
     @Override
     protected void dump(FileDescriptor fd, PrintWriter pw, String[] args) {
         if (mContext.checkCallingOrSelfPermission(android.Manifest.permission.DUMP)
@@ -703,6 +711,10 @@ public final class WifiP2pServiceImpl extends IWifiP2pManager.Stub {
                     replyToMessage(message, WifiP2pManager.START_WPS_FAILED,
                         WifiP2pManager.BUSY);
                     break;
+                case WifiP2pManager.CANCEL_WPS:
+                    replyToMessage(message, WifiP2pManager.CANCEL_WPS_FAILED,
+                        WifiP2pManager.BUSY);
+                    break;
                 case WifiP2pManager.GET_HANDOVER_REQUEST:
                 case WifiP2pManager.GET_HANDOVER_SELECT:
                     replyToMessage(message, WifiP2pManager.RESPONSE_GET_HANDOVER_MESSAGE, null);
@@ -848,6 +860,10 @@ public final class WifiP2pServiceImpl extends IWifiP2pManager.Stub {
                     replyToMessage(message, WifiP2pManager.START_WPS_FAILED,
                             WifiP2pManager.P2P_UNSUPPORTED);
                     break;
+                case WifiP2pManager.CANCEL_WPS:
+                    replyToMessage(message, WifiP2pManager.CANCEL_WPS_FAILED,
+                            WifiP2pManager.P2P_UNSUPPORTED);
+                    break;
                 case WifiP2pManager.START_LISTEN:
                     replyToMessage(message, WifiP2pManager.START_LISTEN_FAILED,
                             WifiP2pManager.P2P_UNSUPPORTED);
@@ -1344,8 +1360,10 @@ public final class WifiP2pServiceImpl extends IWifiP2pManager.Stub {
                         } else {
                             ret = mWifiNative.p2pGroupAdd(true);
                         }
-                    } else {
+                    } else if (netId == -1) {
                         ret = mWifiNative.p2pGroupAdd(false);
+                    } else {
+                        ret = mWifiNative.p2pGroupAdd(netId);
                     }
 
                     if (ret) {
@@ -2019,6 +2037,7 @@ public final class WifiP2pServiceImpl extends IWifiP2pManager.Stub {
                      */
                     enableBTCoex();
                     if (mWifiNative.p2pGroupRemove(mGroup.getInterface())) {
+                        mAutonomousGroup = false;
                         transitionTo(mOngoingGroupRemovalState);
                         replyToMessage(message, WifiP2pManager.REMOVE_GROUP_SUCCEEDED);
                     } else {
@@ -2091,6 +2110,13 @@ public final class WifiP2pServiceImpl extends IWifiP2pManager.Stub {
                     replyToMessage(message, ret ? WifiP2pManager.START_WPS_SUCCEEDED :
                             WifiP2pManager.START_WPS_FAILED);
                     break;
+                case WifiP2pManager.CANCEL_WPS:
+                    if (mWifiNative.cancelWps(mGroup.getInterface())) {
+                        replyToMessage(message, WifiP2pManager.CANCEL_WPS_SUCCEDED);
+                    } else {
+                        replyToMessage(message, WifiP2pManager.CANCEL_WPS_FAILED, WifiP2pManager.ERROR);
+                    }
+                    break;
                 case WifiP2pManager.CONNECT:
                     WifiP2pConfig config = (WifiP2pConfig) message.obj;
                     if (isConfigInvalid(config)) {
